<!DOCTYPE html>
<html lang="ko">
<head>
    {# head}
</head>
<body>
	{#left}
	{#header}
    <main class="container">
        <div role="document">
			<div role="heading">권한</div>
			<section class="section-search">
                <form role="search" name="searchForm" id="searchForm">
                    <input type="hidden" name="coId" id="coId" value="{_SESSION.coId}"/>
                    <div class="search-input">
                        <input type="text" name="searchText" id="searchText" value="{? _GET.searchText}{_GET.searchText}{/}" placeholder="검색어를 입력하세요">
                        <button id="searchBtn" class="btn-search" type="button"><i class="fa-light fa-magnifying-glass"></i></button>
                    </div>
					<button type="button" class="btn" id="insertBtn">추가</button>
                </form>
            </section>
			<section role="list">
                <div class="list-cont">
                    <table>
                        <thead>
                            <tr>
                                <th>권한명</th>
                                <th>작성자</th>
                                <th>작성일</th>
                            </tr>
                        </thead>
                        <tbody>
                            {@ result.authList}
                            <tr>
                                <td><strong><a href="javascript:editor('{.id}');">{.name}</a></strong></td>
                                <td>{.insert.managerId}</td>
                                <td>{.insert.date}</td>
                            </tr>
                            {/}
                        </tbody>
                    </table>
                </div>
                {# paging}
            </section>
        </div>
    </main>


    <!-- ########## START : INLINE SCRIPT ########## -->
    <script type="text/javascript">
        $(document).ready(function() {
            // 버튼 : 추가
            $('#insertBtn').click(function() {
                location.href='/auth/editor';
            });

            // 버튼 : 삭제
            // $('#delBtn').click(function() {
            //     var check = '';
            //     $("input[name=checkRow]:checked").each(function() {
            //         check += $(this).val() + '|';
            //     });

            //     if(!check) {
            //         alert('삭제할 항목을 선택하세요.');
            //     }else{
            //         deleteProc(chkCompany);
            //     }
            // });

            // 버튼 : 검색
            $('#searchBtn').click(function() {
                $('#searchForm').attr('action','/auth/list').submit();
            });
        });

        // 이동 : 수정 페이지
        function editor(id) {
            location.href = "/auth/editor?id="+id
        }

        // 삭제 처리
        function deleteProc(id) {
            if( confirm('선택하신 권한을 삭제하시겠습니까?') ) {
                $.ajax({
                    url: '/auth/deleteProc/ajax',
                    method : 'post',
                    data : {'id': id},
                    dataType: 'json',
                }).done(function(data, textStatus, jqXHR) {
                    if(data.result.msg) {alert(data.result.msg)}
                    location.href = '/auth/list';   // 이동 페이지
                }).fail(function(jqXHR, textStatus, errorThrown) {
                    if (!!jqXHR?.responseJSON?.result?.msg) {
                        alert(jqXHR.responseJSON.result.msg);
                    } else {
                        alert(textStatus+' : '+errorThrown);
                    }
                });
            }
        }
    </script>
    <!-- ########## END : INLINE SCRIPT ########## -->
</body>
</html>